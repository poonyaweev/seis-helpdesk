<!DOCTYPE html>
<html>
<head>
  <title>Terms of Service</title>
  <link rel="stylesheet" href="/style.css">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    async function loginWithSEIS(event) {
      event.preventDefault();
      
      try {
        const response = await axios.post(
          '/api/seis-login',
          {},
          {
            headers: {
              'Content-Type': 'application/json'
            }
          }
        );
        
        // Store the API response in sessionStorage
        const userData = response.data;
        console.log('API Response:', userData);
        
        // Store the fullname in sessionStorage
        if (userData.data && userData.data['0'] && userData.data['0'].fullname) {
          sessionStorage.setItem('userFullname', userData.data['0'].fullname);
        }
        
        // Redirect to /create page after successful API call
        window.location.href = '/create';
        
      } catch (error) {
        console.error('Error calling SEIS API:', error);
        alert('เกิดข้อผิดพลาดในการเชื่อมต่อกับระบบ กรุณาลองใหม่อีกครั้ง');
      }
    }
  </script>
</head>
<body>
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">เงื่อนไขการใช้งาน</h3>
        </div>
        <div class="card-body">
          <p class="text-muted mb-4">โปรดอ่านเงื่อนไขต่อไปนี้ก่อนดำเนินการแจ้งปัญหา</p>
          
          <div class="form-group mb-4">
            <div class="form-control" style="height: 300px; overflow-y: auto;">
              <p>การกดปุ่ม "ลงชื่อเข้าใช้ด้วย SEIS" แสดงว่าคุณได้อ่านและยอมรับข้อกำหนดและเงื่อนไขเหล่านี้แล้ว</p>
              <ol>
                <li>โปรแกรมนี้จะเก็บหมายเลขโทรศัพท์และ LINE ID ของคุณเพื่อใช้ในการอ้างอิง</li>
                <li>เจ้าหน้าที่ของเราอาจติดต่อคุณผ่านโทรศัพท์หรือ LINE เพื่อขอข้อมูลเพิ่มเติม</li>
              </ol>
            </div>
          </div>
          
          <div class="d-flex">
            <a href="/" class="btn btn-link">ปฏิเสธ</a>
            <button onclick="loginWithSEIS(event)" class="btn btn-primary ms-auto">ลงชื่อเข้าใช้ด้วย SEIS</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>